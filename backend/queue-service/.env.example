# Queue Service Configuration

# Server Configuration
PORT=3003
NODE_ENV=development
SERVICE_NAME=queue-service

# Database Configuration
DB_HOST=localhost
DB_PORT=5432
DB_NAME=encore
DB_USER=encore_user
DB_PASSWORD=your_db_password
DB_SSL=false
DB_MAX_CONNECTIONS=20
DB_IDLE_TIMEOUT=30000
DB_CONNECTION_TIMEOUT=2000

# Redis Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_KEY_PREFIX=encore:queue:
REDIS_CONNECTION_TIMEOUT=5000
REDIS_COMMAND_TIMEOUT=3000
REDIS_RETRY_ATTEMPTS=3

# JWT Configuration
JWT_SECRET=your_super_secret_jwt_key_here
JWT_EXPIRES_IN=24h
JWT_REFRESH_SECRET=your_refresh_token_secret
JWT_REFRESH_EXPIRES_IN=7d

# CORS Configuration
CORS_ORIGIN=http://localhost:3000,http://localhost:5173
CORS_CREDENTIALS=true
CORS_METHODS=GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With

# Rate Limiting Configuration
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false
RATE_LIMIT_SKIP_FAILED_REQUESTS=false

# Queue-specific Rate Limits
QUEUE_RATE_LIMIT_WINDOW_MS=900000
QUEUE_RATE_LIMIT_MAX=100
ADD_SONG_RATE_LIMIT_WINDOW_MS=300000
ADD_SONG_RATE_LIMIT_MAX=10
ADMIN_RATE_LIMIT_WINDOW_MS=900000
ADMIN_RATE_LIMIT_MAX=200

# Logging Configuration
LOG_LEVEL=info
LOG_FORMAT=combined
LOG_FILE_ENABLED=true
LOG_FILE_PATH=logs/queue-service.log
LOG_FILE_MAX_SIZE=10m
LOG_FILE_MAX_FILES=5
LOG_CONSOLE_ENABLED=true
LOG_ERROR_FILE=logs/queue-error.log

# WebSocket Configuration
WEBSOCKET_CORS_ORIGIN=http://localhost:3000,http://localhost:5173
WEBSOCKET_CORS_CREDENTIALS=true
WEBSOCKET_PING_TIMEOUT=60000
WEBSOCKET_PING_INTERVAL=25000
WEBSOCKET_MAX_HTTP_BUFFER_SIZE=1e6
WEBSOCKET_TRANSPORTS=websocket,polling
WEBSOCKET_ALLOW_UPGRADES=true
WEBSOCKET_COOKIE=false

# Queue Settings
MAX_SONGS_PER_USER=3
PRIORITY_PLAY_COST=10
MAX_QUEUE_SIZE=100
AUTO_APPROVE_SONGS=false
SONG_COOLDOWN_MINUTES=30
QUEUE_POSITION_UPDATE_INTERVAL=5000

# Cache Settings (in seconds)
CACHE_DEFAULT_TTL=300
CACHE_QUEUE_TTL=300
CACHE_CURRENT_SONG_TTL=60
CACHE_QUEUE_STATS_TTL=600
CACHE_USER_POSITION_TTL=30
CACHE_COOLDOWN_TTL=1800

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_DB=true
HEALTH_CHECK_REDIS=true

# Monitoring Configuration
MONITORING_ENABLED=true
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# External Service URLs
AUTH_SERVICE_URL=http://localhost:3001
MUSIC_SERVICE_URL=http://localhost:3002
POINTS_SERVICE_URL=http://localhost:3004
MENU_SERVICE_URL=http://localhost:3005
ANALYTICS_SERVICE_URL=http://localhost:3006

# Service Discovery
SERVICE_REGISTRY_ENABLED=false
SERVICE_REGISTRY_URL=http://localhost:8500
SERVICE_REGISTRY_CHECK_INTERVAL=30000

# Development/Debug Configuration
DEBUG_ENABLED=false
DEBUG_NAMESPACE=encore:queue
VERBOSE_LOGGING=false
DEBUG_SQL=false
DEBUG_REDIS=false
DEBUG_WEBSOCKET=false

# Security Configuration
TRUST_PROXY=false
SECURE_COOKIES=false
CSRF_PROTECTION=false
HELMET_ENABLED=true
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6

# Queue Event Configuration
EVENT_EMITTER_MAX_LISTENERS=100
QUEUE_EVENT_BATCH_SIZE=10
QUEUE_EVENT_BATCH_TIMEOUT=1000
EVENT_RETRY_ATTEMPTS=3
EVENT_RETRY_DELAY=1000

# WebSocket Room Management
ROOM_CLEANUP_INTERVAL=300000
MAX_ROOMS_PER_USER=5
ROOM_INACTIVITY_TIMEOUT=1800000
USER_CONNECTION_LIMIT=3

# Queue Position Calculation
POSITION_CALCULATION_METHOD=weighted
PRIORITY_WEIGHT_MULTIPLIER=2
TIME_WEIGHT_FACTOR=1
POINTS_WEIGHT_FACTOR=1.5

# Backup and Recovery
BACKUP_ENABLED=false
BACKUP_INTERVAL=3600000
BACKUP_RETENTION_DAYS=7
BACKUP_STORAGE_PATH=./backups

# Feature Flags
FEATURE_PRIORITY_PLAY=true
FEATURE_SONG_COOLDOWN=true
FEATURE_USER_LIMITS=true
FEATURE_QUEUE_STATS=true
FEATURE_AUTO_APPROVE=false
FEATURE_REAL_TIME_UPDATES=true
FEATURE_QUEUE_REORDERING=true
FEATURE_ADMIN_CONTROLS=true

# Performance Configuration
MAX_CONCURRENT_CONNECTIONS=1000
CONNECTION_POOL_SIZE=10
QUERY_TIMEOUT=30000
REQUEST_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=5000
HEADERS_TIMEOUT=60000

# Error Handling
ERROR_STACK_TRACE=true
ERROR_DETAILS_IN_RESPONSE=true
UNHANDLED_REJECTION_ACTION=log
UNCAUGHT_EXCEPTION_ACTION=exit

# Graceful Shutdown
GRACEFUL_SHUTDOWN_TIMEOUT=30000
SHUTDOWN_SIGNALS=SIGTERM,SIGINT
CLEANUP_ON_EXIT=true