# Points Service Configuration

# Server Configuration
PORT=3004
NODE_ENV=development
SERVICE_NAME=points-service

# Database Configuration
DB_HOST=localhost
DB_PORT=5432
DB_NAME=encore_points
DB_USER=postgres
DB_PASSWORD=your_password
DB_SSL=false
DB_MAX_CONNECTIONS=20
DB_IDLE_TIMEOUT=30000
DB_CONNECTION_TIMEOUT=2000

# Redis Configuration
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=2
REDIS_KEY_PREFIX=points:
REDIS_CONNECTION_TIMEOUT=5000
REDIS_COMMAND_TIMEOUT=3000

# JWT Configuration
JWT_SECRET=your_super_secret_jwt_key_for_points_service
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# CORS Configuration
CORS_ORIGIN=http://localhost:3000,http://localhost:5173
CORS_CREDENTIALS=true

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_PAYMENT_MAX=5
RATE_LIMIT_TRANSACTION_MAX=10
RATE_LIMIT_ADMIN_MAX=30
RATE_LIMIT_WEBHOOK_MAX=1000

# Logging Configuration
LOG_LEVEL=info
LOG_FORMAT=combined
LOG_FILE_ENABLED=true
LOG_FILE_PATH=./logs/points-service.log
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5
LOG_DATE_PATTERN=YYYY-MM-DD

# Stripe Configuration
STRIPE_PUBLISHABLE_KEY=pk_test_your_stripe_publishable_key
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret
STRIPE_API_VERSION=2023-10-16

# Points System Configuration
POINTS_RATE=0.01
POINTS_MIN_PURCHASE=100
POINTS_MAX_PURCHASE=100000
POINTS_BONUS_THRESHOLD_1=500
POINTS_BONUS_RATE_1=0.05
POINTS_BONUS_THRESHOLD_2=1000
POINTS_BONUS_RATE_2=0.10
POINTS_BONUS_THRESHOLD_3=2500
POINTS_BONUS_RATE_3=0.15
POINTS_BONUS_THRESHOLD_4=5000
POINTS_BONUS_RATE_4=0.20
POINTS_BONUS_THRESHOLD_5=10000
POINTS_BONUS_RATE_5=0.25

# Payment Configuration
PAYMENT_CURRENCY=usd
PAYMENT_MIN_AMOUNT=0.50
PAYMENT_MAX_AMOUNT=1000.00
PAYMENT_TIMEOUT=1800000
PAYMENT_RETRY_ATTEMPTS=3
PAYMENT_RETRY_DELAY=5000

# Cache Configuration
CACHE_TTL_USER_BALANCE=300
CACHE_TTL_POINTS_STATS=600
CACHE_TTL_PAYMENT_STATS=900
CACHE_TTL_LEADERBOARD=1800
CACHE_TTL_PAYMENT_DATA=3600

# Health Check Configuration
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_DB_ENABLED=true
HEALTH_CHECK_REDIS_ENABLED=true
HEALTH_CHECK_STRIPE_ENABLED=true

# Monitoring Configuration
MONITORING_ENABLED=true
METRICS_PORT=9004
METRICS_PATH=/metrics
TRACING_ENABLED=false
TRACING_ENDPOINT=http://localhost:14268/api/traces

# External Services
AUTH_SERVICE_URL=http://localhost:3001
MUSIC_SERVICE_URL=http://localhost:3002
QUEUE_SERVICE_URL=http://localhost:3003
MENU_SERVICE_URL=http://localhost:3005
ANALYTICS_SERVICE_URL=http://localhost:3006

# Service Discovery
SERVICE_REGISTRY_URL=http://localhost:8500
SERVICE_REGISTRY_ENABLED=false
SERVICE_HEALTH_CHECK_URL=http://localhost:3004/api/health

# Development/Debug
DEBUG=points:*
VERBOSE_LOGGING=false
DEBUG_SQL=false
DEBUG_REDIS=false
DEBUG_STRIPE=false

# Security
TRUST_PROXY=false
SECURE_COOKIES=false
CSRF_PROTECTION=false
HELMET_ENABLED=true
COMPRESSION_ENABLED=true

# Points Transaction Configuration
TRANSACTION_BATCH_SIZE=100
TRANSACTION_TIMEOUT=30000
TRANSACTION_RETRY_ATTEMPTS=3
TRANSACTION_LOCK_TIMEOUT=5000

# Payment Processing
PAYMENT_PROCESSING_DELAY=1000
PAYMENT_WEBHOOK_RETRY_ATTEMPTS=5
PAYMENT_WEBHOOK_RETRY_DELAY=2000
PAYMENT_CONFIRMATION_TIMEOUT=300000

# Bulk Operations
BULK_OPERATION_MAX_USERS=100
BULK_OPERATION_BATCH_SIZE=10
BULK_OPERATION_DELAY=100
BULK_OPERATION_TIMEOUT=60000

# Leaderboard Configuration
LEADERBOARD_MAX_SIZE=100
LEADERBOARD_UPDATE_INTERVAL=300000
LEADERBOARD_CACHE_TTL=1800

# Statistics Configuration
STATS_CALCULATION_INTERVAL=3600000
STATS_RETENTION_DAYS=90
STATS_AGGREGATION_BATCH_SIZE=1000

# Backup and Recovery
BACKUP_ENABLED=false
BACKUP_INTERVAL=86400000
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=encore-backups
BACKUP_S3_REGION=us-east-1

# Feature Flags
FEATURE_POINTS_TRANSFER=true
FEATURE_BULK_OPERATIONS=true
FEATURE_PAYMENT_METHODS=true
FEATURE_REFUNDS=true
FEATURE_LEADERBOARDS=true
FEATURE_STATISTICS=true

# Performance
MAX_CONCURRENT_PAYMENTS=50
MAX_CONCURRENT_TRANSACTIONS=100
CONNECTION_POOL_SIZE=20
QUERY_TIMEOUT=30000

# Error Handling
ERROR_REPORTING_ENABLED=true
ERROR_REPORTING_URL=https://api.sentry.io/projects/your-project
ERROR_STACK_TRACE_LIMIT=10

# Graceful Shutdown
GRACEFUL_SHUTDOWN_TIMEOUT=30000
SHUTDOWN_SIGNALS=SIGTERM,SIGINT
CLEANUP_ON_EXIT=true